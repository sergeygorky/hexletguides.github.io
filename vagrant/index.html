<!DOCTYPE html>
<html lang="ru_RU">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="icon" href="/assets/images/favicons/favicon-128.png">

    
      <link rel="amphtml" href="https://guides.hexlet.io/amp/vagrant">
    

    <title>Что такое Vagrant | Гайды для программистов</title>

    <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Что такое Vagrant | Гайды для программистов</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Что такое Vagrant" />
<meta name="author" content="Кирилл Мокевнин" />
<meta property="og:locale" content="ru_RU" />
<meta name="description" content="Программа для автоматизированной работы с окружением разработчика, позволяющая командам любого размера быстро разворачивать одинаковые системы." />
<meta property="og:description" content="Программа для автоматизированной работы с окружением разработчика, позволяющая командам любого размера быстро разворачивать одинаковые системы." />
<link rel="canonical" href="https://guides.hexlet.io/vagrant/" />
<meta property="og:url" content="https://guides.hexlet.io/vagrant/" />
<meta property="og:site_name" content="Гайды для программистов" />
<meta property="og:image" content="https://guides.hexlet.io/assets/images/vagrant/vagrant.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-12-20T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://guides.hexlet.io/assets/images/vagrant/vagrant.jpg" />
<meta property="twitter:title" content="Что такое Vagrant" />
<script type="application/ld+json">
{"@type":"BlogPosting","description":"Программа для автоматизированной работы с окружением разработчика, позволяющая командам любого размера быстро разворачивать одинаковые системы.","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://guides.hexlet.io/assets/images/hexlet_logo.png"},"name":"Кирилл Мокевнин"},"headline":"Что такое Vagrant","dateModified":"2017-12-20T00:00:00+00:00","datePublished":"2017-12-20T00:00:00+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://guides.hexlet.io/vagrant/"},"url":"https://guides.hexlet.io/vagrant/","author":{"@type":"Person","name":"Кирилл Мокевнин"},"image":"https://guides.hexlet.io/assets/images/vagrant/vagrant.jpg","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    
    

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KMJ8HKG');</script>
<!-- End Google Tag Manager -->




    <link href="/assets/css/theme.css" rel="stylesheet">

    <!-- custom CSS - Remove this if you don't use it or choose to customize the stylesheet with sass-->
    <link href="/assets/css/custom.css" rel="stylesheet">
    <link href="/assets/css/highlight.css" rel="stylesheet">
    <!-- custom CSS end-->

  </head>

  

  <body class="layout-post">

    

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KMJ8HKG"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->



    <!-- Menu Navigation
      ================================================== -->

      <div class="container mb-4">
        <div class="d-flex flex-wrap justify-content-center py-3">
          <a class="navbar-brand me-auto" href="/"><img width="30" alt="Code Basics logo" src="/assets/images/hexlet_logo.png"></a>
          <ul class="nav nav-pills">
            <li class="nav-item">
              <a class="nav-link" target="_blank" href="https://github.com/Hexlet/hexletguides.github.io">Исходный код</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" target="_blank" href="https://ru.hexlet.io/programs?utm_source=hexlet-guides&utm_medium=referral">Программы обучения</a>
            </li>
          </ul>
        </div>
      </div>

      <!-- Container
        ================================================== -->
        <main class="container">
          <div class="row">
  <div class="col-sm-8 mx-auto">
    <!-- Post Featured Image -->
    
    <!-- End Featured Image -->
    <div class="mainheading">
      <h1 class="posttitle">Что такое Vagrant</h1>
    </div>

    <!-- Post Content -->
    <div class="article-post">
      <p><strong>Vagrant — продукт компании HashiCorp, специализирующейся на инструментах для автоматизации разработки и эксплуатации. Он позволяет создавать и конфигурировать легковесные, повторяемые и переносимые окружения для разработки.</strong></p>

<p>Первая задача любого разработчика на новом проекте - развернуть окружение. Как правило, она сводится к следующим шагам:</p>

<ol>
  <li>Клонировать репозиторий с проектом.</li>
  <li>Поставить необходимые пакеты для работы (например, библиотеку для xml).</li>
  <li>Установить дополнительные программы, такие как базу данных.</li>
  <li>Правильно настроить конфигурационные параметры.</li>
</ol>

<p>Без автоматизации подобный процесс может занимать как часы, так и целые дни, в зависимости от сложности проекта. Причем, для каждого человека в команде. Для каждой смены рабочей машины или после переустановки системы. Проблема усугубляется тем, что чем больше разработчиков на проекте, тем более разнообразные машины они используют, включая разные операционные системы. В подобном случае процесс настройки гарантированно будет разным, что является еще одним источником проблем. Весь процесс настройки должен быть где-то описан, но, как правило, эти описания быстро устаревают и их мало кто хочет поддерживать, а любые попытки поддерживать актуальность в конце концов угасают.</p>

<p>После добавления пары таких проектов операционная система становится сильно захламленной. Даже если вы не работаете над проектом, после включения компьютера начнут стартовать сервисы, которые требуются только для разработки.</p>

<p>Еще одна проблема - изменения. Практически любая перенастройка установленной конфигурации потребует ручного вмешательства, доустановки пакетов, программ или изменения конфигов.</p>

<p>И последнее: нередко требуется возможность развернуть проект и для не программистов, например верстальщиков или тестировщиков. Наличие даже хорошо описанного процесса установки мало им поможет.</p>

<p>Теперь можно попробовать сформулировать требования к идеальному окружению:</p>

<ol>
  <li>Изолированность. Таким образом избегаются возможные конфликты с другими окружениями (например, основной системой) и основная система остается чистой.</li>
  <li>Повторяемость. Пересоздать рабочую среду можно за считанные минуты набрав буквально одну команду. Любое изменение распространяется сразу для всех.</li>
  <li>Переносимость. Окружение разворачивается под любой системой одним универсальным способом.</li>
</ol>

<p>Vagrant создан для решения именно этих задач. Во многом его работа опирается на виртуализацию, для которой, по умолчанию, используется продукт <a href="https://www.virtualbox.org/">VirtualBox</a>. Но в отличие от обычной работы с виртуальной машиной, когда внутри нее стоит система с графической оболочкой, Vagrant создает виртуальную машину доступную только в терминальном режиме (через командную строку), при этом сама разработка продолжается на хост-машине, а вот запуск кода на выполнение происходит внутри машины. Другими словами, редактор ставится на вашу основную систему и код лежит также в ней. Vagrant прозрачно прокидывает код внутрь машины и позволяет его запускать.</p>

<h2 id="подготовка-к-работе">Подготовка к работе</h2>

<p>Использование Vagrant подразумевает некоторую настройку операционной системы и наличие определенных знаний:</p>

<ul>
  <li>Нужно знать, что такое виртуализация и как работать с виртуальными машинами</li>
  <li>Командая строка - единственный способ взаимодействия с вагрантом. Если ваша операционная система Windows, то вам необходимо <a href="https://guides.hexlet.io/development-on-windows/">настроить</a> её.</li>
  <li>Базовое знание сетей, понятие порта.</li>
  <li>На вашем компьютере должно быть хотя бы 4 гигабайта оперативной памяти, хотя даже с таким объемом, работать проблематично. Минимально комфортный уровень - 8 гигабайт.</li>
</ul>

<h2 id="установка">Установка</h2>

<p>Первым делом необходимо поставить систему виртуализации, например VirtualBox. Скачать его под вашу операционную систему можно <a href="https://www.virtualbox.org/wiki/Downloads">здесь</a>.</p>

<p>Затем скачайте установщик Vagrant под вашу операционную систему на странице <a href="https://www.vagrantup.com/downloads.html">Download</a>.</p>

<p>Откройте терминал и убедитесь что вагрант работает:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="syntax"><code>vagrant <span class="nt">-v</span>
</code></pre></div></div>

<h2 id="инициализация">Инициализация</h2>

<p>Дизайн Vagrant предполагает, что мы создаем отдельную конфигурацию на каждый проект (а соответственно и виртуальную машину), а не одну на все. Инициализация выполняется в папке соответствующего проекта командой <code class="language-plaintext highlighter-rouge">vagrant init ubuntu/xenial64</code>. В результате выполнения этой команды Vagrant создаст файл Vagrantfile. Внутри файла описана конфигурация виртуальной машины на языке Ruby. Не страшно, если вы не знакомы с ним, содержимое файла интуитивно понятно, а документация вагранта достаточно подробна.</p>

<p>Кроме создания файла, вагрант скачает на вашу машину образ (image) операционной системы, хранящийся под именем <code class="language-plaintext highlighter-rouge">ubuntu/xenial64</code>. В данном случае речь идет про Ubuntu 16.04. Vagrant поддерживает каталог образов, созданных специально под работу с ним. При необходимости можно выбрать другой, посмотрев его имя в <a href="https://app.vagrantup.com/boxes/search">каталоге</a>. Если открыть файл Vagrantfile, то можно увидеть что имя образа прописано внутри конфигурации:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="syntax"><code><span class="no">Vagrant</span><span class="p">.</span><span class="nf">configure</span><span class="p">(</span><span class="s1">'2'</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">box</span> <span class="o">=</span> <span class="s1">'ubuntu/xenial64'</span>
<span class="k">end</span>
</code></pre></div></div>

<h2 id="рабочий-процесс">Рабочий процесс</h2>

<h3 id="запуск">Запуск</h3>

<p>Старт выполняется командой <code class="language-plaintext highlighter-rouge">vagrant up</code>. Она создает виртуальную машину и запускает ее. Если машина уже была создана (предыдущими запусками), то произойдет только старт.</p>

<p>В этот момент уже можно начинать работать с кодом, лежащим в той же папке, что и Vagrantfile. Все изменения автоматически оказываются внутри запущенной виртуальной машины.</p>

<h3 id="подключение">Подключение</h3>

<p>Для входа внутрь используется команда <code class="language-plaintext highlighter-rouge">vagrant ssh</code>. После выполнения терминал подключается к машине в домашнюю директорию пользователя по умолчанию. Традиционно в вагранте это пользователь с именем <code class="language-plaintext highlighter-rouge">vagrant</code>. Теперь необходимо выполнить переход в папку <code class="language-plaintext highlighter-rouge">/vagrant</code>. Именно в ней окажется код проекта.</p>

<p>Дальше можно действовать по старинке. Поставить все необходимые пакеты и зависимости, а затем запустить проект. Если это веб-сайт, то он запустится на определенном порту. По умолчанию все, что стартует внутри виртуальной машины, доступно только внутри. Для возможности обращаться к сайту с хост машины (через ваш любимый браузер), необходимо прокинуть соответствующий порт наружу. Об этом достаточно подробно рассказано в <a href="https://www.vagrantup.com/docs/networking/basic_usage.html">документации</a>. Предположим, что внутри вагранта сайт стартует на порту 8080, и вы хотите обращаться к нему снаружи. Для этого достаточно добавить в конфигурацию:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="syntax"><code><span class="no">Vagrant</span><span class="p">.</span><span class="nf">configure</span><span class="p">(</span><span class="s2">"2"</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
  <span class="c1"># ...</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">vm</span><span class="p">.</span><span class="nf">network</span> <span class="s2">"forwarded_port"</span><span class="p">,</span> <span class="ss">guest: </span><span class="mi">8080</span><span class="p">,</span> <span class="ss">host: </span><span class="mi">8080</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Изменения применяются после перезагрузки машины. Для этого достаточно выполнить команду <code class="language-plaintext highlighter-rouge">vagrant reload</code>.</p>

<h3 id="остановка">Остановка</h3>

<p>В конце работы не забудьте выполнить <code class="language-plaintext highlighter-rouge">vagrant halt</code>, иначе машина останется запущенной и будет потреблять ресурсы. Если вы решили, что пора полностью все удалить и поставить заново, воспользуйтесь командой <code class="language-plaintext highlighter-rouge">vagrant destroy</code>.</p>

<h2 id="конфигурация-системы">Конфигурация системы</h2>

<p>Установка необходимых программ внутрь вагранта традиционным способом — не самый лучший способ добиться повторяемости. По сути такой подход ничем не отличается от настройки проекта на основной системе. Для решения задачи настройки используются средства configuration management, подобные Ansible. Вагрант хорошо интегрируется с ними. Подробнее об этом можно прочитать в официальной <a href="https://www.vagrantup.com/docs/provisioning/">документации</a>, а в одном из репозиториев хекслета есть <a href="https://github.com/hexlet-boilerplates/vagrant-ansible">пример</a> такой интеграции.</p>

<h2 id="плагины">Плагины</h2>

<p>Vagrant может расширяться плагинами. Полный список можно найти на <a href="https://github.com/hashicorp/vagrant/wiki/Available-Vagrant-Plugins">wiki</a>.</p>

<p>Самый важный из этих плагинов - <a href="https://github.com/dotless-de/vagrant-vbguest">vagrant-vbguest</a>.</p>

<p>Не вдаваясь в подробности, он делает так, что ваша система всегда остается рабочей при обновлении виртуальной машины. Без него возможна ситуация, когда обновив виртуальную машину вы увидите, что папка с кодом перестала синхронизироваться, и внутри вагранта её нет.</p>

<h2 id="решение-проблем">Решение проблем</h2>

<ul>
  <li>Убедитесь что в BIOS включены все необходимые параметры для нормального функционирования виртуализации.</li>
  <li>В Windows используйте имена пользователей, не содержащие кириллицы.</li>
  <li>Не запускайте вагрант из под суперпользователя или администратора.</li>
  <li>Если вы испытываете проблемы со скоростью работы, то, возможно, причина в способе синхронизирования папки с проектом. Vagrant <a href="https://www.vagrantup.com/docs/synced-folders/">позволяет</a> настраивать способ синхронизации.</li>
</ul>

    </div>

    <div class="lead d-flex my-5">
      <span class="me-auto">
        <a href="https://github.com/Hexlet/hexletguides.github.io/tree/master/_posts/2017-12-20-vagrant.md" target="_blank">
          Исходный код (github)
        </a>
      </span>
      
        <i>Кирилл Мокевнин</i>
      
    </div>

    <!-- Prev/Next -->
    <div class="row PageNavigation mt-4 prevnextlinks d-flex justify-content-between">
      
      <div class="col-md-6 rightborder pl-0">
        <a class="thepostlink" href="https://guides.hexlet.io/development-on-windows/">&laquo; Как начать разрабатывать в Windows</a>
      </div>
      
      
      <div class="col-md-6 text-right pr-0">
        <a class="thepostlink" href="https://guides.hexlet.io/jekyll/">Как завести блог на Jekyll &raquo;</a>
      </div>
      
    </div>
    <!-- End Prev/Next -->

    <section>
      <div id="comments">
        <section class="disqus">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'hexlet-guides'; 
        var disqus_developer = 0;
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = window.location.protocol + '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>

      </div>
    </section>
  </div>
</div>

        </main>

        <!-- Footer
          ================================================== -->
          <footer class="footer container text-center">

            <ul class="p-0 mb-1 small">
              
              <li>
                <a href="https://ru.hexlet.io/courses" alt="Курсы" target="_blank">Курсы</a>
              </li>
              
              <li>
                <a href="https://cv.hexlet.io/" alt="Оценка резюме" target="_blank">Оценка резюме</a>
              </li>
              
              <li>
                <a href="https://codebattle.hexlet.io/" alt="Алгоритмическая прокачка" target="_blank">Алгоритмическая прокачка</a>
              </li>
              
            </ul>
          </footer>

          <!-- JavaScript
            ================================================== -->
            <script src="/assets/js/theme.js"></script>
  </body>
</html>
